<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Weather Dashboard</title>

<style>
body {
  font-family: Arial;
  background:#0f172a;
  color:white;
  text-align:center;
}

.card {
  background:#1e293b;
  padding:20px;
  margin:15px;
  border-radius:12px;
  display:inline-block;
  width:260px;
}

h2 {
  margin-top:30px;
  font-size:20px;
}
</style>
</head>

<body>

<h1>ğŸŒ¦ Weather Stations</h1>

<select id="dev">
  <option value="max1">max1</option>
  <option value="max2">max2</option>
  <option value="max3">max3</option>
  <option value="max4">max4</option>
</select>

<div id="out"></div>

<script>
async function load() {
  const dev = document.getElementById("dev").value;

  const r = await fetch("/api/sensor?device=" + dev);
  const data = await r.json();

  if (!data.today || !data.yesterday || (data.today.length === 0 && data.yesterday.length === 0)) {
    document.getElementById("out").innerHTML = "No data";
    return;
  }

  let html = "";

  // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙŠÙˆÙ…
  if (data.today.length > 0) {
    const d = data.today[data.today.length - 1]; // Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙŠÙˆÙ…
    html += `
    <h2>ğŸ“… Today</h2>
    <div class="card">
      ğŸŒ¡ Temp: ${d.temperture.toFixed(1)} Â°C<br>
      ğŸ’§ Humidity: ${d.humidity.toFixed(1)} %<br>
      â² Pressure: ${d.pressure.toFixed(1)} hPa<br>
      ğŸ’¨ Wind Speed: ${d.winds ?? 0} m/s<br>
      ğŸ§­ Direction: ${d.windd}<br>
      ğŸ•’ ${new Date(d.time).toLocaleString()}
    </div>`;
  }

  // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù…Ø³
  if (data.yesterday.length > 0) {
    const d = data.yesterday[data.yesterday.length - 1]; // Ø¢Ø®Ø± Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø£Ù…Ø³
    html += `
    <h2>ğŸ“… Yesterday</h2>
    <div class="card">
      ğŸŒ¡ Temp: ${d.temperture.toFixed(1)} Â°C<br>
      ğŸ’§ Humidity: ${d.humidity.toFixed(1)} %<br>
      â² Pressure: ${d.pressure.toFixed(1)} hPa<br>
      ğŸ’¨ Wind Speed: ${d.windS ?? 0} m/s<br>
      ğŸ§­ Direction: ${d.windD}<br>
      ğŸ•’ ${new Date(d.reading_date || d.time).toLocaleString()}
    </div>`;
  }

  document.getElementById("out").innerHTML = html;
}

document.getElementById("dev").onchange = load;

load();
setInterval(load, 5000);
</script>
</body>
</html>
