<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Weather Station Dashboard</title>

<style>
body {
  font-family: Arial;
  background: #0f172a;
  color: white;
  text-align: center;
}

.card {
  background: #1e293b;
  margin: 15px;
  padding: 20px;
  border-radius: 12px;
  display: inline-block;
  width: 260px;
}

.value {
  font-size: 22px;
  margin: 6px;
}
</style>
</head>

<body>

<h1>ğŸŒ¦ Weather Stations</h1>

<div id="cards"></div>

<script>
const devices = ["max1","max2","max3","max4"];

async function loadDevice(device){

  const res = await fetch(
    "https://esp32-weatherstation.vercel.app/api/sensor?device=" + device
  );

  if(!res.ok) return null;

  const data = await res.json();
  if(data.length === 0) return null;

  return data[data.length-1];
}

async function refresh(){

  let html = "";

  for(const d of devices){

    const row = await loadDevice(d);

    if(!row){
      html += `<div class="card"><h3>${d}</h3>No data</div>`;
      continue;
    }

    html += `
    <div class="card">
      <h3>${d}</h3>
      <div class="value">ğŸŒ¡ ${row.temperture.toFixed(1)} Â°C</div>
      <div class="value">ğŸ’§ ${row.humidity.toFixed(1)} %</div>
      <div class="value">â² ${row.pressure.toFixed(1)} hPa</div>
      <div class="value">ğŸ’¨ ${row.winds.toFixed?.(1) ?? row.winds} m/s</div>
      <div class="value">ğŸ§­ ${row.windd}</div>
      <div style="font-size:12px">${row.time}</div>
    </div>`;
  }

  document.getElementById("cards").innerHTML = html;
}

refresh();
setInterval(refresh, 5000);
</script>

</body>
</html>
